{% macro input(mk, field) %}
  </td>
  <td>{{ mk.input(field) }}</td>
  </tr>
{% endmacro %}

{% macro select(mk, field) %}
  </td>
  <td>
  {{ mk.select.open(field, class=field.properties.css_class) }}
  {{ mk.option(field, value="", contents="--") }}
  
  {% for value in field.valid_values %}
      {% set value_label = (field.properties.value_labels[value]
          if field.properties.value_labels else value) %}
  {{ mk.option(field, value=value, contents=value_label) }}
  {% endfor %}
  {{ mk.select.close() }}
  </td>
  </tr>
{% endmacro %}

{% macro radioselect(mk, field) %}
  
  {% for value in field.valid_values %}
      {% set value_label = (field.properties.value_labels[value]
          if field.properties.value_labels else value) %}
  {{ mk.input(field, type='radio', value=value) }}
  {% endfor %}

{% endmacro %}

{% macro checkbox(mk, field) %}
  </td>
  <td>{{ mk.input(field, type="checkbox") }}</td>
  </tr>
{% endmacro %}

{% macro subgroup(mk, schema) %}
  </td>
  </tr>
  {%- for name in mk.children_order(schema) %}
    {% set field = schema[name] %}
        {{ mk.widget(field) }}
      {% endfor -%}
{% endmacro %}

{% macro group(mk, group) %}
    {%- for name in mk.children_order(group) %}
    </td></tr>
    <tr>
      <td class="control-group {{ error_cls }}">
        {% set field = group[name] %}
        {% set error_cls = 'error' if field.errors else '' %}
        {{ mk.label(field, class='control-label', contents=field.label) }}
      </td>
      <td>
        {{ mk.widget(field) }}
        <span class="controls">
          {% for message in field.errors %}
            <span class="help-inline">{{ message }}</span>
          {% endfor %}
        </span>
      </td>
    </tr>
    {%- endfor %}
{% endmacro %}

{% macro schema(mk, schema) %}
  {%- do mk.begin(auto_domid=true, auto_for=true) %}
  <table>
  <tbody>
  {%- for name in mk.children_order(schema) %}
    {% set field = schema[name] %}
    <tr> 
      <td colspan="2"><h3>{{ field.label }}</h3>
        {{ mk.widget(field) }} {#widget closes cell and row#}
  {% endfor -%}
  {% do mk.end() -%}
  </tbody>
  </table>
{% endmacro %}

{% macro topics_columns(mk, schema) %}
  </td>
  {%- for name in mk.children_order(schema) %}
  <td>
    {% set field = schema[name] %}
    {{ mk.widget(field) }}
  </td>
  {% endfor -%}
  </tr>
{% endmacro %}

{% macro options_with_labels(mk, schema) %}
  {%- do mk.begin(auto_domid=true, auto_for=true) %}
  {%- for name in mk.children_order(schema) %}
    {% set field = schema[name] %}
    {{ field.label }} {{ mk.widget(field) }}
  {% endfor -%}
  {% do mk.end() -%}
{% endmacro %}
